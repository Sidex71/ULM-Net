<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Inferring Physical Cell-cell Interaction Networks from ScRNAseq Data • ULM</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Inferring Physical Cell-cell Interaction Networks from ScRNAseq Data">
<meta name="description" content="A novel approach to depict physical cell-cell interactions from scRNAseq datasets using cell type-specifc gene signatures. This method utilizes univariate linear models to identify and predict the cellular composition of multiplets in scRNAseq by assigning signature scores to cellular barcodes.">
<meta property="og:description" content="A novel approach to depict physical cell-cell interactions from scRNAseq datasets using cell type-specifc gene signatures. This method utilizes univariate linear models to identify and predict the cellular composition of multiplets in scRNAseq by assigning signature scores to cellular barcodes.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ULM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/ULM-vignette.html">ULM-vignette</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Sidex71/ULM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="ulm">ULM<a class="anchor" aria-label="anchor" href="#ulm"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>An R package for the prediction and identification of multiplets from scRNAseq datasets to infer physical cell-cell interaction networks. Multiplets occur naturally in conventional scRNAseq due to incomplete dissociation during library preparation. They represent cells which are physically connected and interacting in tissues which become sequenced together as they remain unseperated. ULM utilizes a signature-based approach where univariate linear models are fitted over each barcode in a scRNAseq data to assign signature scores. Barcodes are then classified as singlets or multiplets based on their signature scores. Multiplets are those barcodes or cells that are enriched in two or more cell type-specific gene signatures.</p>
<p><img src="reference/figures/algorithm.jpeg" style="width:100.0%"></p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of ULM from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"devtools"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"Sidex71/ULM"</span>, build_vignettes <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p>A full guide on ULM workflow can be found on the package website <a href="https://sidex71.github.io/ULM/articles/ULM-vignette.html" class="uri">https://sidex71.github.io/ULM/articles/ULM-vignette.html</a> or on the vignettes page by running</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/browseVignettes.html" class="external-link">browseVignettes</a></span><span class="op">(</span><span class="st">'ULM'</span><span class="op">)</span> </span>
<span><span class="co">#&gt; No vignettes found by browseVignettes("ULM")</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h2>
<p>This package depends on Seurat (&gt;= 3.0.0), decoupleR, tidyverse, dplyr, stringr, igraph, ggraph, tidygraph, ggplot2, magrittr, tibble. All required packages might be automatically installed alongside the ULM package.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This is a quick example which shows how to infer physical cell-cell interaction network from a scRNAseq data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Sidex71/ULM" class="external-link">ULM</a></span><span class="op">)</span></span>
<span><span class="co">####load dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"int_singData"</span><span class="op">)</span>  <span class="co">##int_singData is a preprocessed scRNAseq seurat object with a Cell_Type column containing cell annotations.</span></span>
<span><span class="co">##generate signatures</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101324</span><span class="op">)</span></span>
<span><span class="va">int_sig</span> <span class="op">&lt;-</span> <span class="fu">ULM</span><span class="fu">::</span><span class="fu"><a href="reference/GetSignature.html">GetSignature</a></span><span class="op">(</span><span class="va">int_singData</span>, ident_col <span class="op">=</span> <span class="va">int_singData</span><span class="op">$</span><span class="va">Cell_Type</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">#&gt; using the specified seurat ident to generate signatures</span></span>
<span><span class="co">#&gt; Calculating cluster Progenitor early</span></span>
<span><span class="co">#&gt; Warning: The `slot` argument of `GetAssayData()` is deprecated as of SeuratObject 5.0.0.</span></span>
<span><span class="co">#&gt; ℹ Please use the `layer` argument instead.</span></span>
<span><span class="co">#&gt; ℹ The deprecated feature was likely used in the Seurat package.</span></span>
<span><span class="co">#&gt;   Please report the issue at &lt;https://github.com/satijalab/seurat/issues&gt;.</span></span>
<span><span class="co">#&gt; This warning is displayed once every 8 hours.</span></span>
<span><span class="co">#&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span>
<span><span class="co">#&gt; generated.</span></span>
<span><span class="co">#&gt; Warning: `PackageCheck()` was deprecated in SeuratObject 5.0.0.</span></span>
<span><span class="co">#&gt; ℹ Please use `rlang::check_installed()` instead.</span></span>
<span><span class="co">#&gt; ℹ The deprecated feature was likely used in the Seurat package.</span></span>
<span><span class="co">#&gt;   Please report the issue at &lt;https://github.com/satijalab/seurat/issues&gt;.</span></span>
<span><span class="co">#&gt; This warning is displayed once every 8 hours.</span></span>
<span><span class="co">#&gt; Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span>
<span><span class="co">#&gt; generated.</span></span>
<span><span class="co">#&gt; Calculating cluster Progenitor late-1</span></span>
<span><span class="co">#&gt; Calculating cluster Transit amplifying</span></span>
<span><span class="co">#&gt; Calculating cluster Progenitor late-2</span></span>
<span><span class="co">#&gt; Calculating cluster Goblet</span></span>
<span><span class="co">#&gt; Calculating cluster Stem</span></span>
<span><span class="co">#&gt; Calculating cluster Enterocyte</span></span>
<span><span class="co">#&gt; Calculating cluster Paneth</span></span>
<span><span class="co">#&gt; Calculating cluster Enteroendocrine</span></span>
<span><span class="co">#&gt; Calculating cluster Tuft</span></span>
<span></span>
<span><span class="co">###score cells and assign labels</span></span>
<span><span class="va">my_scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/GetCellScores.html">GetCellScores</a></span><span class="op">(</span>seurat_obj <span class="op">=</span> <span class="va">int_singData</span>, signatures <span class="op">=</span> <span class="va">int_sig</span>, assay <span class="op">=</span> <span class="st">'RNA'</span>, layer  <span class="op">=</span> <span class="st">'data'</span><span class="op">)</span></span>
<span><span class="va">my_assign</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/GetCellAssignments.html">GetCellAssignments</a></span><span class="op">(</span>score_data <span class="op">=</span> <span class="va">my_scores</span>, cut_off <span class="op">=</span> <span class="fl">1</span>, p_val <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="va">int_singData</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/AddMetaObject.html">AddMetaObject</a></span><span class="op">(</span><span class="va">int_singData</span>, cell_class_df <span class="op">=</span> <span class="va">my_assign</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#####filter multiplets</span></span>
<span><span class="va">my_mult_filt</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/FilterMultiplet.html">FilterMultiplet</a></span><span class="op">(</span><span class="va">int_singData</span>, minCells <span class="op">=</span> <span class="fl">2</span>, minFreq <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removing 1929 cells missing data for vars requested</span></span>
<span><span class="va">multSummaryFilt</span> <span class="op">&lt;-</span> <span class="va">my_mult_filt</span><span class="op">$</span><span class="va">multSummaryFilt</span></span>
<span></span>
<span><span class="co">###plot network</span></span>
<span><span class="va">my_node_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/GetNodeDF.html">GetNodeDF</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">multSummaryFilt</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/PlotNetwork.html">PlotNetwork</a></span><span class="op">(</span><span class="va">my_node_df</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-example-1.png" width="100%"></p>
<p>A more comprehensive guide on the usage of the ULM package can be found in the following link <a href="https://sidex71.github.io/ULM/articles/ULM-vignette.html" class="uri">https://sidex71.github.io/ULM/articles/ULM-vignette.html</a></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Sidex71/ULM/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 3)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ULM</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Sodiq A. Hameed <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-1539-8088" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Luis F. Iglesias-Martinez <br><small class="roles"> Author </small>   </li>
<li>Walter Kolch <br><small class="roles"> Author </small>   </li>
<li>Vadim Zhernovkov <br><small class="roles"> Author </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sodiq A. Hameed, Luis F. Iglesias-Martinez, Walter Kolch, Vadim Zhernovkov.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
